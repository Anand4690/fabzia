<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bookings - Fabzia Turf</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Utility CSS -->
    <link rel="stylesheet" href="utility.css">
    
    <style>
        body {
            background-color: var(--bg-light);
            font-family: 'Lato', sans-serif;
        }

        .mobile-container {
            max-width: 430px;
            margin: 0 auto;
            background-color: var(--bg-light);
            min-height: 100vh;
            position: relative;
            padding-bottom: 80px; /* Space for bottom nav */
        }

        .tab-button {
            position: relative;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            color: var(--green);
            border-bottom: 2px solid var(--green);
        }

        /* Status Badge Styles */
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            color: var(--white-pure);
            display: inline-block;
        }
        .status-booked { background-color: var(--green); border: 1px solid var(--green); }
        .status-payment-due { background-color: var(--warning); border: 1px solid var(--warning); }
        .status-cancelled { background-color: var(--error); border: 1px solid var(--error); }

        /* Card Border Colors */
        .border-l-brand-green { border-left-color: var(--green); }
        .border-l-warning { border-left-color: var(--warning); }
        .border-l-error { border-left-color: var(--error); }

        /* Hide scrollbar for slots */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body>

    <div class="mobile-container">
        <!-- Top Navigation -->
        <header class="sticky top-0 z-40 bg-white border-b border-[var(--bg-container)] px-4 py-3 h-16 flex items-center gap-2">
            <a href="Home.html" class="flex items-center justify-center w-12 h-12 flex-shrink-0 hover:bg-gray-50 rounded-full transition-colors">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="var(--text-heading)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
            <h1 class="text-[var(--text-heading)] text-lg font-normal">Bookings</h1>
        </header>

        <!-- Tabs -->
        <div class="sticky top-16 z-30 bg-white border-b border-[var(--bg-container)] px-4 flex justify-between">
            <button onclick="switchTab('upcoming')" id="upcoming-tab" class="tab-button active w-1/2 py-[17px] text-center text-[16px] font-semibold text-[var(--text-heading)]">
                Upcoming
            </button>
            <button onclick="switchTab('previous')" id="previous-tab" class="tab-button w-1/2 py-[17px] text-center text-[16px] font-medium text-[var(--text-body)]">
                Previous
            </button>
        </div>

        <!-- Content Area -->
        <main class="md:p-4 p-3 space-y-3 mt-2 min-h-[calc(100vh-200px)]">
            
            <!-- Upcoming List -->
            <div id="upcoming-list" class="space-y-3">
                <!-- Content injected via JS -->
            </div>

            <!-- Empty State (Hidden via JS if items exist) -->
            <div id="empty-state" class="hidden flex-col items-center justify-center pt-20 gap-4 text-center">
                <p class="text-[var(--text-heading)] text-base font-normal">
                    You've no upcoming bookings.
                </p>
                <a href="Home.html" class="text-[var(--green)] text-base font-medium hover:underline">
                    Start Booking Now
                </a>
            </div>

            <!-- Previous List (Currently empty for demo, but structure ready) -->
            <div id="previous-list" class="space-y-3 hidden">
                 <div class="flex flex-col items-center justify-center pt-20 gap-4 text-center">
                    <p class="text-[var(--text-heading)] text-base font-normal">
                        You've no previous bookings.
                    </p>
                    <a href="Home.html" class="text-[var(--green)] text-base font-medium hover:underline">
                        Start Booking Now
                    </a>
                </div>
            </div>

        </main>

        <!-- Bottom Sheet for Cancellation Policy -->
        <div id="policy-sheet" class="fixed inset-0 bg-black/50 z-50 hidden flex-col justify-end opacity-0 pointer-events-none transition-opacity duration-300">
            <div class="bg-white w-full rounded-t-2xl max-h-[80vh] overflow-y-auto transform translate-y-full transition-transform duration-300 ease-out" id="policy-content">
                <div class="p-6">
                    <h2 class="text-xl font-semibold text-[var(--text-heading)] mb-4">
                        Cancellation & Refund Policy
                    </h2>
                    <div class="space-y-4 text-[var(--text-body)] text-sm leading-6">
                        <p>Cancellations made 24 hours before the booking time are eligible for a full refund.</p>
                        <p>Cancellations made between 12-24 hours before the booking time will receive a 50% refund.</p>
                        <p>Cancellations made less than 12 hours before the booking time are not eligible for any refund.</p>
                        <p class="text-gray-500 text-xs mt-2">Refunds will be processed within 5-7 business days to the original payment method.</p>
                    </div>

                    <!-- Bottom Buttons -->
                    <div class="flex gap-3 mt-6">
                        <button onclick="closePolicySheet()" class="flex-1 py-3 border border-gray-300 rounded font-medium text-[var(--text-heading)]">
                            Back
                        </button>
                        <button onclick="confirmCancellation()" class="flex-1 py-3 bg-[var(--error)] text-white rounded font-medium">
                            Cancel Booking
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cancel Confirmation Modal -->
        <div id="cancel-modal" class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300">
            <div class="bg-white rounded-lg p-6 max-w-sm w-full transform scale-95 transition-transform duration-200" id="cancel-modal-content">
                <h3 class="text-lg font-semibold text-[var(--text-heading)] mb-2">
                    Are you sure you want to cancel?
                </h3>
                <p class="text-sm text-[var(--text-body)] mb-6">
                    This action cannot be reverted.
                </p>
                <div class="flex gap-3">
                    <button onclick="closeCancelModal()" class="flex-1 py-2 border border-gray-300 rounded font-medium text-[var(--text-heading)]">
                        No
                    </button>
                    <button onclick="finalizeCancellation()" class="flex-1 py-2 bg-[var(--error)] text-white rounded font-medium">
                        Yes
                    </button>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 bg-[var(--white-pure)] border-t border-[var(--bg-container)] flex justify-center w-full z-40 max-w-[430px] mx-auto">
            <div class="w-full h-16 flex items-center justify-between px-6">
                <!-- Home Item -->
                <a href="Home.html" class="nav-item flex flex-col items-center justify-center gap-1 min-w-0 group">
                    <div class="w-6 h-6 flex items-center justify-center">
                        <svg class="inactive-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2.98416C12.1774 2.98416 12.349 3.04727 12.4844 3.1619L19.9844 9.52518H19.9854C20.0683 9.59554 20.1349 9.68334 20.1807 9.78201C20.2264 9.88075 20.25 9.98864 20.25 10.0974V19.4998C20.25 19.6986 20.1709 19.8894 20.0303 20.0301C19.8896 20.1707 19.6989 20.2498 19.5 20.2498H14.75V13.2498H9.25V20.2498H4.5C4.30109 20.2498 4.11038 20.1707 3.96973 20.0301C3.82914 19.8894 3.75 19.6986 3.75 19.4998V10.0974L3.75488 10.0154C3.76373 9.93481 3.78512 9.85592 3.81934 9.78201C3.86505 9.68334 3.93173 9.59554 4.01465 9.52518H4.01562L11.5156 3.1619L11.5146 3.16092C11.6161 3.07498 11.7388 3.01899 11.8682 2.99588L12 2.98416Z" stroke="var(--black)" stroke-width="1.5"/>
                        </svg>
                    </div>
                    <span class="text-sm font-medium text-[var(--text-heading)]">Home</span>
                </a>
                <!-- Events Item -->
                <a href="Events.html" class="nav-item flex flex-col items-center justify-center gap-1 min-w-0 group">
                    <div class="w-6 h-6 flex items-center justify-center">
                        <svg class="inactive-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_events_inactive_b)">
                                <path d="M2.04127 17.9516C1.87222 17.7826 1.76616 17.5506 1.76616 17.292L1.76947 14.3653C1.76616 13.8847 2.14402 13.4737 2.62794 13.4339C3.34389 13.3808 3.90074 12.824 3.95377 12.1081C4.01343 11.3192 3.42012 10.6264 2.62794 10.5635C2.14402 10.5237 1.76616 10.1127 1.76947 9.63208L1.76947 6.70863C1.76947 6.19156 2.18711 5.77393 2.70086 5.77724L14.6598 5.77724C14.9449 5.77724 15.2332 5.84685 15.4918 5.9728C15.5945 6.02252 15.7138 6.02252 15.81 5.9728C16.0652 5.84353 16.3569 5.77724 16.6419 5.77724L21.3022 5.77724C21.8193 5.77724 22.2369 6.19488 22.2336 6.70864L22.2336 9.63871C22.2369 10.1193 21.859 10.5303 21.3751 10.5701C20.6293 10.6264 20.046 11.2562 20.0427 12.002C20.046 12.7478 20.6293 13.3775 21.3751 13.4339C21.8624 13.4703 22.2402 13.8813 22.2369 14.3686L22.2369 17.292C22.2369 17.8091 21.8193 18.2267 21.3055 18.2234L16.6452 18.2234C16.3602 18.2234 16.0718 18.1538 15.8133 18.0279C15.7105 17.9781 15.5912 17.9781 15.4951 18.0279C15.2399 18.1571 14.9482 18.2234 14.6631 18.2234L2.69755 18.2234C2.44564 18.2234 2.21031 18.1207 2.04127 17.9516ZM3.26765 14.8426L3.26765 16.7252L14.6565 16.7252C14.7095 16.7252 14.7692 16.712 14.8156 16.6855C15.336 16.4236 15.9591 16.4236 16.4795 16.6855C16.5292 16.7087 16.5856 16.7252 16.6386 16.7252L20.7354 16.7252L20.7354 14.8492C20.1984 14.71 19.7145 14.4183 19.33 14.0073C18.8262 13.4637 18.5478 12.7544 18.5412 12.0119C18.5412 11.2695 18.8196 10.5602 19.3234 10.0166C19.7046 9.60225 20.1918 9.31388 20.7321 9.17136L20.7354 7.27874L16.6386 7.27874C16.5856 7.27874 16.5292 7.29526 16.4795 7.31843C15.9591 7.58032 15.336 7.58032 14.8156 7.31843C14.7692 7.29195 14.7095 7.27874 14.6565 7.27874L3.26765 7.27874L3.26765 9.15481C3.80463 9.29402 4.28851 9.58571 4.67304 9.99682C5.17683 10.5405 5.45523 11.2497 5.46184 11.9922C5.45523 12.7346 5.17683 13.444 4.67304 13.9875C4.2885 14.4019 3.80463 14.6902 3.26765 14.8326V14.8426Z" fill="var(--black)"/>
                                <path d="M15.1205 8.51838C14.9847 8.38248 14.9018 8.19355 14.9018 7.98805L14.9018 6.89424C14.9018 6.48324 15.2399 6.14515 15.6509 6.14515C16.0619 6.14515 16.4 6.48324L16.4 7.98805C16.4 8.39906 16.0619 8.73714 15.6509 8.73714C15.4421 8.74046 15.2564 8.65428 15.1205 8.51838Z" fill="var(--black)"/>
                                <path d="M15.1173 11.4385C14.9814 11.3026 14.8985 11.1137 14.8985 10.9082L14.8985 10.179C14.8952 9.76464 15.2333 9.42655 15.6476 9.42986C16.0619 9.42655 16.4 9.76463 16.3967 10.179L16.3967 10.9082C16.4 11.3225 16.0619 11.6606 15.6476 11.6573C15.4421 11.6573 15.2531 11.5744 15.1173 11.4385Z" fill="var(--black)"/>
                                <path d="M15.1173 14.3553C14.9814 14.2194 14.8985 14.0305 14.8985 13.825L14.8985 13.0958C14.9018 12.6815 15.2366 12.3467 15.6476 12.3467C16.0619 12.35 16.3967 12.6848 16.3967 13.0958L16.3967 13.825C16.3934 14.2393 16.0586 14.5741 15.6476 14.5741C15.4421 14.5741 15.2531 14.4912 15.1173 14.3553Z" fill="var(--black)"/>
                                <path d="M15.1205 17.6401C14.9847 17.5042 14.9018 17.3152 14.9018 17.1097L14.9018 16.0159C14.9018 15.6049 15.2399 15.2668 15.6509 15.2668C16.0619 15.2668 16.4 15.6049 16.4 16.0159L16.4 17.1097C16.4 17.5207 16.0619 17.8588 15.6509 17.8588C15.4454 17.8588 15.2564 17.776 15.1205 17.6401Z" fill="var(--black)"/>
                            </g>
                            <defs>
                                <clipPath id="clip0_events_inactive_b">
                                    <rect width="24" height="24" fill="white"/>
                                </clipPath>
                            </defs>
                        </svg>
                    </div>
                    <span class="text-sm font-medium text-[var(--text-heading)]">Events</span>
                </a>
                <!-- Coaching Item -->
                <a href="Coaching.html" class="nav-item flex flex-col items-center justify-center gap-1 min-w-0 group">
                    <div class="w-6 h-6 flex items-center justify-center">
                        <svg class="inactive-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8.019 10.923C6.51267 10.923 5.22908 10.3926 4.16825 9.33175C3.10725 8.27075 2.57675 6.98708 2.57675 5.48075C2.57675 5.27392 2.58992 5.06708 2.61625 4.86025C2.64258 4.65342 2.67558 4.46792 2.71525 4.30375C2.63842 4.33708 2.55125 4.36892 2.45375 4.36925C2.35625 4.37942 2.27067 4.3845 2.197 4.3845C1.57717 4.3845 1.056 4.17258 0.6335 3.74875C0.211167 3.32492 0 2.80608 0 2.19225C0 1.57842 0.201917 1.05958 0.60575 0.63575C1.00942 0.211916 1.51967 0 2.1365 0C2.64167 0 3.091 0.144583 3.4845 0.433749C3.87817 0.722749 4.141 1.08975 4.273 1.53475C4.75883 1.07308 5.32867 0.708333 5.9825 0.4405C6.63633 0.1725 7.31517 0.0384995 8.019 0.0384995H19.019V3.0385H13.4613V5.48075C13.4613 6.99242 12.9322 8.27742 11.874 9.33575C10.8158 10.3939 9.53083 10.923 8.019 10.923ZM2.19225 3.19225C2.47558 3.19225 2.71308 3.09642 2.90475 2.90475C3.09642 2.71308 3.19225 2.47558 3.19225 2.19225C3.19225 1.90892 3.09642 1.67142 2.90475 1.47975C2.71308 1.28808 2.47558 1.19225 2.19225 1.19225C1.90892 1.19225 1.67142 1.28808 1.47975 1.47975C1.28808 1.67142 1.19225 1.90892 1.19225 2.19225C1.19225 2.47558 1.28808 2.71308 1.47975 2.90475C1.67142 3.09642 1.90892 3.19225 2.19225 3.19225ZM8.0205 9.1155C9.02467 9.1155 9.88125 8.7605 10.5903 8.0505C11.2992 7.34067 11.6538 6.48367 11.6538 5.4795C11.6538 4.47517 11.2988 3.6185 10.589 2.9095C9.879 2.2005 9.02192 1.846 8.01775 1.846C7.01358 1.846 6.157 2.201 5.448 2.911C4.739 3.62083 4.3845 4.47783 4.3845 5.482C4.3845 6.48633 4.73942 7.343 5.44925 8.052C6.15908 8.761 7.01617 9.1155 8.0205 9.1155Z" fill="var(--black)" transform="translate(2, 7)"/>
                        </svg>
                    </div>
                    <span class="text-sm font-medium text-[var(--text-heading)]">Coaching</span>
                </a>
                <!-- More Item -->
                <a href="More.html" class="nav-item flex flex-col items-center justify-center gap-1 min-w-0 group">
                    <div class="w-6 h-6 flex items-center justify-center">
                        <svg class="inactive-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21.25 12C21.25 6.89137 17.1086 2.75 12 2.75C6.89136 2.75 2.75 6.89136 2.75 12C2.75 17.1086 6.89137 21.25 12 21.25C17.1086 21.25 21.25 17.1086 21.25 12ZM8.25 12C8.25 12.6903 7.69039 13.25 7 13.25C6.30961 13.25 5.75 12.6903 5.75 12C5.75 11.3097 6.30961 10.75 7 10.75C7.69039 10.75 8.25 11.3097 8.25 12ZM13.25 12C13.25 12.6903 12.6903 13.25 12 13.25C11.3097 13.25 10.75 12.6903 10.75 12C10.75 11.3097 11.3097 10.75 12 10.75C12.6903 10.75 13.25 11.3097 13.25 12ZM18.25 12C18.25 12.6903 17.6903 13.25 17 13.25C16.3097 13.25 15.75 12.6903 15.75 12C15.75 11.3097 16.3097 10.75 17 10.75C17.6903 10.75 18.25 11.3097 18.25 12ZM22.75 12C22.75 17.937 17.937 22.75 12 22.75C6.06293 22.75 1.25 17.937 1.25 12C1.25 6.06294 6.06294 1.25 12 1.25C17.937 1.25 22.75 6.06293 22.75 12Z" fill="var(--black)"/>
                        </svg>
                    </div>
                    <span class="text-sm font-medium text-[var(--text-heading)]">More</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- Script Logic for Tabs, Rendering, and Modals -->
    <script>
        // Data from React component
        const bookings = [
            {
                id: '1',
                title: 'The Multi-Sports Turf (7v7)',
                date: '12 Jan 2026',
                time: '5-6pm',
                status: 'booked',
                borderColor: 'border-l-brand-green',
                bookingId: '12VB',
                bookingDate: '12/12/26',
                totalAmount: '₹2,051',
                advancePaid: '₹600',
                pendingBalance: '₹1,451',
                slots: [
                    { time: '12 AM- 12.30 PM', type: '7v7 (Half 1)' },
                    { time: '1 PM- 2.30 PM', type: '5v5 (Half 2)' }
                ]
            },
            {
                id: '2',
                title: 'The Multi-Sports Turf (7v7)',
                date: '12 Jan 2026',
                time: '5-6pm',
                status: 'payment-due',
                borderColor: 'border-l-warning',
                bookingId: '12VB',
                bookingDate: '12/12/26',
                totalAmount: '₹2,051',
                advancePaid: '₹600',
                pendingBalance: '₹1,451',
                slots: [
                    { time: '12 AM- 12.30 PM', type: '7v7 (Half 1)' },
                    { time: '1 PM- 2.30 PM', type: '5v5 (Half 2)' }
                ]
            },
            {
                id: '3',
                title: 'The Multi-Sports Turf (7v7)',
                date: '12 Jan 2026',
                time: '5-6pm',
                status: 'cancelled',
                borderColor: 'border-l-error',
                bookingId: '12VB',
                bookingDate: '12/12/26',
                totalAmount: '₹2,051',
                advancePaid: '₹600',
                pendingBalance: '₹1,451',
                slots: [
                    { time: '12 AM- 12.30 PM', type: '7v7 (Half 1)' },
                    { time: '1 PM- 2.30 PM', type: '5v5 (Half 2)' }
                ]
            },
            {
                id: '4',
                title: 'The Multi-Sports Turf (7v7)',
                date: '12 Jan 2026',
                time: '5-6pm',
                status: 'booked',
                borderColor: '',
                bookingId: '12VB',
                bookingDate: '12/12/26',
                totalAmount: '₹2,051',
                advancePaid: '₹600',
                pendingBalance: '₹1,451',
                slots: [
                    { time: '12 AM- 12.30 PM', type: '7v7 (Half 1)' },
                    { time: '1 PM- 2.30 PM', type: '5v5 (Half 2)' }
                ]
            }
        ];

        // State similar to React
        let expandedCards = new Set(['4']);
        let selectedBookingId = null;

        function init() {
            renderBookings();
        }

        function renderBookings() {
            const listContainer = document.getElementById('upcoming-list');
            const emptyState = document.getElementById('empty-state');

            if (bookings.length === 0) {
                listContainer.innerHTML = '';
                listContainer.classList.add('hidden');
                emptyState.classList.remove('hidden');
                emptyState.classList.add('flex');
                return;
            } else {
                listContainer.classList.remove('hidden');
                emptyState.classList.add('hidden');
                emptyState.classList.remove('flex');
            }

            // Generate HTML
            listContainer.innerHTML = bookings.map(booking => {
                const isExpanded = expandedCards.has(booking.id);
                // Determines border class based on expanded/collapsed state and border property
                // When collapsed: show colored border. When expanded: no border (as per React logic: `isCollapsed ? ... : ''`)
                const borderClass = !isExpanded && booking.borderColor ? booking.borderColor + ' border-l-[6px]' : '';
                
                return `
                <div class="bg-[var(--white-pure)] rounded-lg overflow-hidden transition-all duration-200 ${borderClass}">
                    <!-- Card Header -->
                    <div class="p-4">
                        <button onclick="toggleCard('${booking.id}')" class="w-full flex items-center justify-between">
                            <div class="text-left">
                                <h3 class="text-base font-semibold text-[var(--text-heading)] leading-7">
                                    ${booking.title}
                                </h3>
                                ${!isExpanded ? `
                                    <p class="text-sm text-[var(--text-body)] leading-[21px] mt-1">
                                        ${booking.date} • ${booking.time}
                                    </p>
                                ` : ''}
                            </div>
                            <div class="text-[var(--text-heading)]">
                                ${isExpanded ? 
                                    '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="stroke-current" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg>' : 
                                    '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="stroke-current" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>'
                                }
                            </div>
                        </button>

                        <!-- Expanded Content -->
                        <div class="mt-2 space-y-3 ${isExpanded ? 'block' : 'hidden'}">
                            <!-- Status Badges -->
                            <div class="flex gap-[7px] flex-wrap">
                                ${booking.id === '4' ? 
                                    // Special case for card 4 (shows all badges in generic React logic provided, keeping it faithful)
                                    getStatusBadgeHTML('booked') + getStatusBadgeHTML('payment-due') + getStatusBadgeHTML('cancelled') 
                                    : getStatusBadgeHTML(booking.status)
                                }
                            </div>

                            <!-- Booking Details -->
                            <div class="space-y-3 py-2">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-[var(--text-body)]">id</span>
                                    <span class="text-sm text-[var(--text-heading)]">${booking.bookingId}</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-[var(--text-body)]">Booking Date</span>
                                    <span class="text-sm text-[var(--text-heading)]">${booking.bookingDate}</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-[var(--text-body)]">Total Amount</span>
                                    <span class="text-sm text-[var(--text-heading)]">${booking.totalAmount}</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-[var(--text-body)]">Advance Paid</span>
                                    <span class="text-sm text-[var(--text-heading)]">${booking.advancePaid}</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-[var(--text-body)]">Pending Balance</span>
                                    <span class="text-sm text-[var(--error)]">${booking.pendingBalance}</span>
                                </div>
                            </div>

                            <!-- Cancel Link -->
                            <div>
                                <button onclick="openPolicySheet('${booking.bookingId}')" class="text-sm text-[var(--text-body)] underline hover:text-[var(--text-heading)]">
                                    Cancel Booking
                                </button>
                            </div>

                            <!-- Horizontal Time Slots -->
                            <div class="flex gap-2 overflow-x-auto pb-2 -mx-4 px-4 no-scrollbar">
                                ${booking.slots.map(slot => `
                                    <div class="flex-shrink-0 border border-gray-300 rounded-lg px-4 py-3 text-center min-w-max">
                                        <div class="text-sm font-medium text-[var(--text-heading)]">${slot.time}</div>
                                        <div class="text-xs text-[var(--text-body)] mt-1">${slot.type}</div>
                                    </div>
                                `).join('')}
                            </div>

                            <!-- Pay Due Button -->
                            <button class="w-full bg-[var(--green-dark)] text-white py-3 rounded-lg font-medium hover:opacity-90 transition-opacity">
                                Pay Due
                            </button>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        function getStatusBadgeHTML(status) {
            let label = '';
            let className = '';
            switch (status) {
                case 'booked':
                    label = 'Booked';
                    className = 'status-booked';
                    break;
                case 'payment-due':
                    label = 'Payment due';
                    className = 'status-payment-due';
                    break;
                case 'cancelled':
                    label = 'Cancelled';
                    className = 'status-cancelled';
                    break;
            }
            return `<span class="status-badge ${className}">${label}</span>`;
        }

        function toggleCard(id) {
            if (expandedCards.has(id)) {
                expandedCards.delete(id);
            } else {
                expandedCards.add(id);
            }
            renderBookings();
        }

        // ---/ Modal & Sheet Logic /---

        function openPolicySheet(id) {
            selectedBookingId = id;
            const sheet = document.getElementById('policy-sheet');
            const content = document.getElementById('policy-content');
            
            sheet.classList.remove('hidden');
            // Trigger reflow for animation
            void sheet.offsetWidth; 
            
            sheet.classList.remove('opacity-0', 'pointer-events-none');
            content.classList.remove('translate-y-full');
        }

        function closePolicySheet() {
            const sheet = document.getElementById('policy-sheet');
            const content = document.getElementById('policy-content');
            
            content.classList.add('translate-y-full');
            sheet.classList.add('opacity-0', 'pointer-events-none');
            
            setTimeout(() => {
                sheet.classList.add('hidden');
            }, 300);
        }

        function confirmCancellation() {
            // Close policy, open confirm
            closePolicySheet();
            setTimeout(() => {
                const modal = document.getElementById('cancel-modal');
                const content = document.getElementById('cancel-modal-content');
                modal.classList.remove('hidden');
                void modal.offsetWidth;
                modal.classList.remove('opacity-0', 'pointer-events-none');
                content.classList.remove('scale-95');
                content.classList.add('scale-100');
            }, 300);
        }

        function closeCancelModal() {
            const modal = document.getElementById('cancel-modal');
            const content = document.getElementById('cancel-modal-content');
            
            content.classList.remove('scale-100');
            content.classList.add('scale-95');
            modal.classList.add('opacity-0', 'pointer-events-none');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 200);
        }

        function finalizeCancellation() {
            console.log('Cancelled booking:', selectedBookingId);
            // Here you would update the booking status in a real app
            closeCancelModal();
        }

        function switchTab(tabName) {
            const upBtn = document.getElementById('upcoming-tab');
            const prevBtn = document.getElementById('previous-tab');
            const upList = document.getElementById('upcoming-list');
            const prevList = document.getElementById('previous-list');
            const emptyState = document.getElementById('empty-state');

            if (tabName === 'upcoming') {
                upBtn.classList.add('active', 'font-semibold', 'text-[var(--text-heading)]');
                upBtn.classList.remove('text-[var(--text-body)]', 'font-medium');
                
                prevBtn.classList.remove('active', 'font-semibold', 'text-[var(--text-heading)]');
                prevBtn.classList.add('text-[var(--text-body)]', 'font-medium');

                upList.classList.remove('hidden');
                prevList.classList.add('hidden');
                
                // Re-check empty state for upcoming
                if (bookings.length === 0) {
                    upList.classList.add('hidden');
                    emptyState.classList.remove('hidden', 'hidden'); 
                    emptyState.classList.add('flex');
                } else {
                    emptyState.classList.add('hidden');
                    emptyState.classList.remove('flex');
                }

            } else {
                prevBtn.classList.add('active', 'font-semibold', 'text-[var(--text-heading)]');
                prevBtn.classList.remove('text-[var(--text-body)]', 'font-medium');
                
                upBtn.classList.remove('active', 'font-semibold', 'text-[var(--text-heading)]');
                upBtn.classList.add('text-[var(--text-body)]', 'font-medium');

                prevList.classList.remove('hidden');
                upList.classList.add('hidden');
                
                // Previous is currently always empty/demo
                emptyState.classList.add('hidden'); // Or show specific previous empty state
                // Since previous list has its own hardcoded empty logic inside HTML
            }
        }

        // Start
        init();

    </script>
</body>
</html>
